function p=LegendreP(nmax,x)% function p=LegendreP(nmax,x)% Computes all Legendre polynomials from n=0 to n=nmax, % them in an array from n=1 to nmax+1% Uses the recursion relation in Numerical Recipes.% T Ferree at EGI% revised 1/19/00p=zeros(nmax+1,1);if nmax>=0	p0=1.0;	p(1)=p0;endif nmax>=1 	p1=x;	p(2)=p1;endif nmax>=2	for j=2:nmax		c1=(2.0*j-1.0)/(1.0*j);		c2=(1.0*j-1.0)/(1.0*j);		p(j+1)=c1*x*p(j-1+1)-c2*p(j-2+1);	endendreturn;